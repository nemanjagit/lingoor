<div class="post-card p-3 rounded-3 mb-3 shadow-sm">
  <div class="d-flex justify-content-between align-items-start">
    <div>
      <h5 class="fw-bold text-primary mb-1">{{ post.word }}</h5>
      <p class="mb-2 text-muted">{{ post.definition }}</p>

      <div class="author small position-relative">
        <span class="author-name" (click)="openFollowPopup()">
          by {{ post.authorUsername }}
        </span>

        <!-- Follow popup -->
        @if (followPopupOpen) {
          <div class="follow-popup mt-1 p-2 rounded shadow-sm bg-white position-absolute">
            <button
              class="btn btn-sm"
              [class.btn-outline-primary]="!post.followingAuthor"
              [class.btn-outline-danger]="post.followingAuthor"
              (click)="toggleFollow()"
            >
              {{ post.followingAuthor ? 'Unfollow' : 'Follow' }}
            </button>
          </div>
        }
      </div>
    </div>

    <div class="d-flex flex-column align-items-center gap-0">
      <!-- Like button -->
      <button
        class="btn border-0 p-1"
        (click)="toggleLike()"
        [disabled]="likeInProgress"
      >
        <i
          class="bi"
          [ngClass]="post.likedByMe ? 'bi-heart-fill text-danger' : 'bi-heart text-muted'"
        ></i>
      </button>
      <div class="small text-secondary">{{ post.likeCount }}</div>

      <!-- Admin / Author actions -->
      @if (isAdmin || isAuthor) {
        <div class="dropdown mt-1">
          <button
            class="btn btn-sm btn-light border-0"
            type="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <i class="bi bi-three-dots-vertical"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end">
            @if (isAuthor || isAdmin) {
              <li>
                <button class="dropdown-item text-danger" (click)="deletePost()">
                  Delete
                </button>
              </li>
            }
            @if (isAdmin) {
              <li>
                <button class="dropdown-item" (click)="setWordOfTheDay()">
                  Set as WOTD
                </button>
              </li>
            }
          </ul>
        </div>
      }
    </div>
  </div>
</div>
